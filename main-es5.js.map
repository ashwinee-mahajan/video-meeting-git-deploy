{"version":3,"sources":["webpack:///$_lazy_route_resource lazy namespace object","webpack:///src/app/app.component.html","webpack:///src/app/app.component.ts","webpack:///src/app/app.module.ts","webpack:///src/environments/environment.ts","webpack:///src/main.ts","webpack:///ws (ignored)"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","module","exports","id","AppComponent","socket","title","room","location","pathname","substring","remotePeers","Array","config","iceServers","urls","constraints","audio","video","facingMode","peerConnections","emit","navigator","mediaDevices","getUserMedia","stream","myVideo","nativeElement","srcObject","play","getUserMediaError","error","console","on","peerConnection","RTCPeerConnection","getTracks","forEach","track","addTrack","createOffer","sdp","setLocalDescription","message","localDescription","ontrack","event","handleRemoteStreamAdded","streams","onicecandidate","candidate","handleRemoteHangup","filter","remotePeer","peerId","close","matchedIndex","findIndex","peer","push","description","setRemoteDescription","createAnswer","addIceCandidate","RTCIceCandidate","alert","window","onunload","onbeforeunload","selector","templateUrl","styleUrls","url","options","AppModule","forRoot","declarations","imports","providers","bootstrap","environment","production","bootstrapModule","err"],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","<div class=\"row border h-75 no-gutters\">\n  <div class=\"col-9 bg-light border h-100 d-flex justify-content-center overlay-container\" >\n      <video class=\"border border-danger w-100 h-100\" autoplay playsinline #myVideo>\n      </video>      \n  </div>\n\n</div>\n\n<div class=\"row flex-nowrap room-members\">\n  <div class=\"col\" *ngFor=\"let remotePeer of remotePeers\">\n    <div>User {{remotePeer?.peerId}} </div>\n      <video [id]=\"remotePeer?.peerId\" class=\"border border-danger w-100 h-100\" autoplay playsinline [srcObject]=\"(remotePeer?.stream)\">\n        \n      </video>\n  </div>\n</div>","import {\n  Component,\n  OnInit,\n  ViewChild,\n  ViewChildren,\n  ElementRef,\n  QueryList,\n} from '@angular/core';\nimport { Socket } from 'ngx-socket-io';\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css'],\n})\nexport class AppComponent implements OnInit {\n  title = 'webrtcsampleapp';\n\n  room = !location.pathname.substring(1)\n    ? 'home'\n    : location.pathname.substring(1);\n  remotePeers: Array<any> = new Array();\n\n  @ViewChild('myVideo')\n  myVideo: ElementRef<HTMLVideoElement>;\n\n  /** @type {RTCConfiguration} */\n  config = {\n    iceServers: [\n      {\n        urls: ['stun:stun.l.google.com:19302'],\n      },\n    ],\n  };\n\n  /** @type {MediaStreamConstraints} */\n  constraints = {\n    audio: true,\n    video: { facingMode: 'user' },\n  };\n\n  peerConnections = {};\n\n  constructor(private socket: Socket) {}\n\n  ngOnInit() {\n    if (this.room && !!this.room) {\n      this.socket.emit('join', this.room);\n    }\n\n    navigator.mediaDevices\n      .getUserMedia(this.constraints)\n      .then((stream) => {\n        this.myVideo.nativeElement.srcObject = stream;\n        this.myVideo.nativeElement.play();\n        this.socket.emit('ready');\n      })\n      .catch(getUserMediaError);\n\n    function getUserMediaError(error) {\n      console.error(error);\n    }\n\n    this.socket.on('ready', async (id) => {\n      \n      const peerConnection = new RTCPeerConnection(this.config);\n      this.peerConnections[id] = peerConnection;\n\n      await navigator.mediaDevices\n        .getUserMedia(this.constraints)\n        .then((stream) => {\n          stream\n            .getTracks()\n            .forEach((track) => peerConnection.addTrack(track, stream));\n        });\n      \n      peerConnection\n        .createOffer()\n        .then((sdp) => peerConnection.setLocalDescription(sdp))\n        .then(() => {\n          this.socket.emit('offer', {\n            id,\n            message: peerConnection.localDescription,\n          });\n        });\n\n      peerConnection.ontrack = (event) =>\n        handleRemoteStreamAdded(event.streams[0], id);\n\n      peerConnection.onicecandidate = (event) => {\n        if (event.candidate) {\n          this.socket.emit('candidate', { id, message: event.candidate });\n        }\n      };\n    });\n\n    const handleRemoteHangup = (id) => {\n      this.remotePeers = this.remotePeers.filter(\n        (remotePeer) => id !== remotePeer.peerId\n      );\n      this.peerConnections[id] && this.peerConnections[id].close();\n      delete this.peerConnections[id];\n    };\n\n    const handleRemoteStreamAdded = (stream, id) => {\n      const matchedIndex = this.remotePeers.findIndex(peer => peer.peerId === id);\n      (matchedIndex === -1) && this.remotePeers.push({ peerId: id, stream: stream });\n    };\n\n    this.socket.on('offer', async (id, description) => {\n      const peerConnection = new RTCPeerConnection(this.config);\n      this.peerConnections[id] = peerConnection;\n      await navigator.mediaDevices\n        .getUserMedia(this.constraints)\n        .then((stream) => {\n          stream\n            .getTracks()\n            .forEach((track) => peerConnection.addTrack(track, stream));\n        });\n\n      peerConnection\n        .setRemoteDescription(description)\n        .then(() => peerConnection.createAnswer())\n        .then((sdp) => peerConnection.setLocalDescription(sdp))\n        .then(() => {\n          this.socket.emit('answer', {\n            id,\n            message: peerConnection.localDescription,\n          });\n        });\n      peerConnection.ontrack = (event) =>\n        handleRemoteStreamAdded(event.streams[0], id);\n      peerConnection.onicecandidate = (event) => {\n        if (event.candidate) {\n          this.socket.emit('candidate', { id, message: event.candidate });\n        }\n      };\n    });\n\n    this.socket.on('candidate', (id, candidate) => {\n      this.peerConnections[id]\n        .addIceCandidate(new RTCIceCandidate(candidate))\n        .catch((e) => console.error(e));\n    });\n\n    this.socket.on('answer', (id, description) => {\n      this.peerConnections[id].setRemoteDescription(description);\n    });\n\n    this.socket.on('full', (room) => {\n      alert('Room ' + room + ' is full');\n    });\n\n    this.socket.on('bye', (id) => {\n      handleRemoteHangup(id);\n    });\n\n    window.onunload = window.onbeforeunload = function () {\n      this.socket.close();\n    };\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { SocketIoModule, SocketIoConfig } from 'ngx-socket-io';\nimport { AppComponent } from './app.component';\n\nconst config: SocketIoConfig = { url: 'http://localhost:3100', options: {}  };\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    SocketIoModule.forRoot(config)\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","/* (ignored) */"]}